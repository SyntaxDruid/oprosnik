/*! For license information please see background.js.LICENSE.txt */
(()=>{function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(e)}function e(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function n(t){for(var n=1;n<arguments.length;n++){var a=null!=arguments[n]?arguments[n]:{};n%2?e(Object(a),!0).forEach(function(e){r(t,e,a[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):e(Object(a)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))})}return t}function r(t,e,n){return(e=s(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function a(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",i=n.toStringTag||"@@toStringTag";function l(n,r,a,i){var l=r&&r.prototype instanceof s?r:s,u=Object.create(l.prototype);return o(u,"_invoke",function(n,r,a){var o,i,l,s=0,u=a||[],f=!1,h={p:0,n:0,v:t,a:d,f:d.bind(t,4),d:function(e,n){return o=e,i=0,l=t,h.n=n,c}};function d(n,r){for(i=n,l=r,e=0;!f&&s&&!a&&e<u.length;e++){var a,o=u[e],d=h.p,m=o[2];n>3?(a=m===r)&&(l=o[(i=o[4])?5:(i=3,3)],o[4]=o[5]=t):o[0]<=d&&((a=n<2&&d<o[1])?(i=0,h.v=r,h.n=o[1]):d<m&&(a=n<3||o[0]>r||r>m)&&(o[4]=n,o[5]=r,h.n=m,i=0))}if(a||n>1)return c;throw f=!0,r}return function(a,u,m){if(s>1)throw TypeError("Generator is already running");for(f&&1===u&&d(u,m),i=u,l=m;(e=i<2?t:l)||!f;){o||(i?i<3?(i>1&&(h.n=-1),d(i,l)):h.n=l:h.v=l);try{if(s=2,o){if(i||(a="next"),e=o[a]){if(!(e=e.call(o,l)))throw TypeError("iterator result is not an object");if(!e.done)return e;l=e.value,i<2&&(i=0)}else 1===i&&(e=o.return)&&e.call(o),i<2&&(l=TypeError("The iterator does not provide a '"+a+"' method"),i=1);o=t}else if((e=(f=h.n<0)?l:n.call(r,h))!==c)break}catch(e){o=t,i=1,l=e}finally{s=1}}return{value:e,done:f}}}(n,a,i),!0),u}var c={};function s(){}function u(){}function f(){}e=Object.getPrototypeOf;var h=[][r]?e(e([][r]())):(o(e={},r,function(){return this}),e),d=f.prototype=s.prototype=Object.create(h);function m(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,f):(t.__proto__=f,o(t,i,"GeneratorFunction")),t.prototype=Object.create(d),t}return u.prototype=f,o(d,"constructor",f),o(f,"constructor",u),u.displayName="GeneratorFunction",o(f,i,"GeneratorFunction"),o(d),o(d,i,"Generator"),o(d,r,function(){return this}),o(d,"toString",function(){return"[object Generator]"}),(a=function(){return{w:l,m}})()}function o(t,e,n,r){var a=Object.defineProperty;try{a({},"",{})}catch(t){a=0}o=function(t,e,n,r){if(e)a?a(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n;else{var i=function(e,n){o(t,e,function(t){return this._invoke(e,n,t)})};i("next",0),i("throw",1),i("return",2)}},o(t,e,n,r)}function i(t,e,n,r,a,o,i){try{var l=t[o](i),c=l.value}catch(t){return void n(t)}l.done?e(c):Promise.resolve(c).then(r,a)}function l(t){return function(){var e=this,n=arguments;return new Promise(function(r,a){var o=t.apply(e,n);function l(t){i(o,r,a,l,c,"next",t)}function c(t){i(o,r,a,l,c,"throw",t)}l(void 0)})}}function c(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,s(r.key),r)}}function s(e){var n=function(e){if("object"!=t(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=t(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==t(n)?n:n+""}function u(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function f(){var t=document.querySelector("#voice-state-select-headerOptionText");return{status:t?t.textContent.trim():null,timestamp:Date.now()}}function h(){var t={phone:null,duration:null,region:null,timestamp:Date.now()},e=document.querySelector('[aria-label*="–£—á–∞—Å—Ç–Ω–∏–∫"]');e&&(t.phone=e.textContent.trim()),console.log("üîç –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ —Ç–∞–π–º–µ—Ä–∞:");var n=document.querySelectorAll('[role="timer"]');console.log('–≠–ª–µ–º–µ–Ω—Ç—ã —Å role="timer":',n.length),n.forEach(function(t,e){console.log("Timer ".concat(e,":"),{id:t.id,textContent:t.textContent,ariaLabel:t.getAttribute("aria-label"),classes:t.className})});var r=document.querySelectorAll('[class*="timer"]');console.log("–≠–ª–µ–º–µ–Ω—Ç—ã —Å –∫–ª–∞—Å—Å–æ–º timer:",r.length),r.forEach(function(t,e){var n=t.textContent.trim();/\d{2}:\d{2}:\d{2}/.test(n)&&console.log("Timer class ".concat(e," (–≤–∞–ª–∏–¥–Ω–æ–µ –≤—Ä–µ–º—è):"),{id:t.id,textContent:n,classes:t.className})});for(var a=0,o=['[role="timer"]','[class*="timer-timer"]','[id*="call-timer"]','[aria-label*="–û–±—â–µ–µ –≤—Ä–µ–º—è"]','.callcontrol-timer-7KaNm [role="timer"]','[id$="call-timer"]',".timer-timer-2ZG4P",'[class*="callcontrol-timer"] [role="timer"]'];a<o.length;a++){var i=o[a];try{var l=document.querySelector(i);if(l&&l.textContent.trim()){var c=l.textContent.trim();if(console.log("–ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–µ–ª–µ–∫—Ç–æ—Ä ".concat(i,': "').concat(c,'"')),/\d{2}:\d{2}:\d{2}/.test(c)){t.duration=c,console.log("‚úÖ –í—Ä–µ–º—è –Ω–∞–π–¥–µ–Ω–æ —á–µ—Ä–µ–∑ —Å–µ–ª–µ–∫—Ç–æ—Ä ".concat(i,": ").concat(c));break}}}catch(t){console.log("‚ùå –û—à–∏–±–∫–∞ —Å —Å–µ–ª–µ–∫—Ç–æ—Ä–æ–º ".concat(i,":"),t.message)}}if(!t.duration){console.log("üîç –ü–æ–∏—Å–∫ –≤—Ä–µ–º–µ–Ω–∏ –≤–æ –≤—Å–µ—Ö —ç–ª–µ–º–µ–Ω—Ç–∞—Ö...");var s,f=!1,h=function(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return u(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?u(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,a=function(){};return{s:a,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,l=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return i=t.done,t},e:function(t){l=!0,o=t},f:function(){try{i||null==n.return||n.return()}finally{if(l)throw o}}}}(document.querySelectorAll("*"));try{for(h.s();!(s=h.n()).done;){var d,m=s.value,g=(null===(d=m.textContent)||void 0===d?void 0:d.trim())||"";/^\d{2}:\d{2}:\d{2}$/.test(g)&&(console.log("üìç –ù–∞–π–¥–µ–Ω —ç–ª–µ–º–µ–Ω—Ç —Å –≤—Ä–µ–º–µ–Ω–µ–º:",{text:g,id:m.id,className:m.className,tagName:m.tagName,ariaLabel:m.getAttribute("aria-label"),role:m.getAttribute("role")}),f||(t.duration=g,f=!0))}}catch(t){h.e(t)}finally{h.f()}}var p=document.querySelector('[class*="callVariableValue"] span');if(p&&(t.region=p.textContent.trim()),!t.region){var v=document.querySelector('[id*="call-header-variable-value"]');v&&(t.region=v.textContent.trim())}return console.log("üìä –§–∏–Ω–∞–ª—å–Ω—ã–µ –∏–∑–≤–ª–µ—á–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:",{phone:t.phone,duration:t.duration,region:t.region,success:!!(t.phone&&t.duration&&t.region)}),t}console.log("üöÄ Background Service Worker —Å –∞–∫—Ç–∏–≤–Ω—ã–º –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–æ–º –∑–∞–ø—É—â–µ–Ω");var d=new(function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.finesseTabId=null,this.monitoringActive=!1,this.currentCallData=null,this.callHistory=[],this.lastAgentStatus=null,this.isInCall=!1,this.callStartTime=null,this.callEndTime=null,this.calculatedDuration=null,this.statusCheckInterval=3e3,this.activeCallInterval=1e3,this.init()},e=[{key:"formatDuration",value:function(t){var e=Math.floor(t/1e3),n=Math.floor(e/3600),r=Math.floor(e%3600/60),a=e%60;return"".concat(n.toString().padStart(2,"0"),":").concat(r.toString().padStart(2,"0"),":").concat(a.toString().padStart(2,"0"))}},{key:"init",value:(v=l(a().m(function t(){return a().w(function(t){for(;;)switch(t.n){case 0:return console.log("üì° –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è FinesseActiveMonitor..."),t.n=1,this.loadStoredData();case 1:return t.n=2,this.findFinesseTab();case 2:chrome.alarms.create("finesseStatusCheck",{periodInMinutes:.05}),chrome.tabs.onUpdated.addListener(this.handleTabUpdate.bind(this)),chrome.tabs.onRemoved.addListener(this.handleTabRemoved.bind(this));case 3:return t.a(2)}},t,this)})),function(){return v.apply(this,arguments)})},{key:"findFinesseTab",value:(p=l(a().m(function t(){var e;return a().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,chrome.tabs.query({url:"https://ssial000ap008.si.rt.ru:8445/desktop/container/*"});case 1:if(!((e=t.v).length>0)){t.n=2;break}return this.finesseTabId=e[0].id,console.log("‚úÖ –ù–∞–π–¥–µ–Ω–∞ –≤–∫–ª–∞–¥–∫–∞ Finesse:",this.finesseTabId),this.monitoringActive=!0,t.a(2,!0);case 2:return console.log("‚ùå –í–∫–ª–∞–¥–∫–∞ Finesse –Ω–µ –Ω–∞–π–¥–µ–Ω–∞"),this.monitoringActive=!1,t.a(2,!1)}},t,this)})),function(){return p.apply(this,arguments)})},{key:"handleTabUpdate",value:function(t,e,n){var r=this;t===this.finesseTabId&&"complete"===e.status&&(console.log("üîÑ –í–∫–ª–∞–¥–∫–∞ Finesse –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–µ–Ω–∞"),setTimeout(function(){return r.checkAgentStatus()},3e3))}},{key:"handleTabRemoved",value:function(t){t===this.finesseTabId&&(console.log("‚ùå –í–∫–ª–∞–¥–∫–∞ Finesse –∑–∞–∫—Ä—ã—Ç–∞"),this.finesseTabId=null,this.monitoringActive=!1)}},{key:"checkAgentStatus",value:(g=l(a().m(function t(){var e,n;return a().w(function(t){for(;;)switch(t.p=t.n){case 0:if(this.monitoringActive&&this.finesseTabId){t.n=2;break}return t.n=1,this.findFinesseTab();case 1:if(this.finesseTabId){t.n=2;break}return t.a(2);case 2:return t.p=2,t.n=3,chrome.scripting.executeScript({target:{tabId:this.finesseTabId},func:f,world:"MAIN"});case 3:if(!((e=t.v)&&e[0]&&e[0].result)){t.n=4;break}return t.n=4,this.processStatusData(e[0].result);case 4:t.n=6;break;case 5:t.p=5,n=t.v,console.error("‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –ø—Ä–æ–≤–µ—Ä–∫–µ —Å—Ç–∞—Ç—É—Å–∞:",n),this.monitoringActive=!1;case 6:return t.a(2)}},t,this,[[2,5]])})),function(){return g.apply(this,arguments)})},{key:"processStatusData",value:(m=l(a().m(function t(e){var n,r,o,i=this;return a().w(function(t){for(;;)switch(t.n){case 0:if(e.status){t.n=1;break}return t.a(2);case 1:n=e.status,r=this.lastAgentStatus,n!==r&&(console.log("üìû –°—Ç–∞—Ç—É—Å –∏–∑–º–µ–Ω–∏–ª—Å—è: ".concat(r," ‚Üí ").concat(n)),"–†–∞–∑–≥–æ–≤–æ—Ä"!==n||this.isInCall||(console.log("üîî –ù–∞—á–∞—Ç –Ω–æ–≤—ã–π –∑–≤–æ–Ω–æ–∫!"),this.isInCall=!0,this.callStartTime=Date.now(),this.callEndTime=null,this.calculatedDuration=null,console.log("‚è∞ –í—Ä–µ–º—è –Ω–∞—á–∞–ª–∞ –∑–≤–æ–Ω–∫–∞ –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–æ:",new Date(this.callStartTime).toLocaleTimeString()),this.startActiveCallMonitoring()),"–†–∞–∑–≥–æ–≤–æ—Ä"===r&&"–ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ"===n&&(this.callEndTime=Date.now(),o=this.callEndTime-this.callStartTime,this.calculatedDuration=this.formatDuration(o),console.log("‚òéÔ∏è –ó–≤–æ–Ω–æ–∫ –∑–∞–≤–µ—Ä—à–∞–µ—Ç—Å—è..."),console.log("‚è∞ –í—Ä–µ–º—è –æ–∫–æ–Ω—á–∞–Ω–∏—è –∑–≤–æ–Ω–∫–∞:",new Date(this.callEndTime).toLocaleTimeString()),console.log("üìä –í—ã—á–∏—Å–ª–µ–Ω–Ω–∞—è –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:",this.calculatedDuration),this.startPostCallCapture()),"–ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ"===r&&"–ì–æ—Ç–æ–≤"===n&&(console.log("‚úÖ –ê–≥–µ–Ω—Ç –≥–æ—Ç–æ–≤ –∫ –Ω–æ–≤—ã–º –∑–≤–æ–Ω–∫–∞–º"),setTimeout(l(a().m(function t(){return a().w(function(t){for(;;)switch(t.n){case 0:return console.log('üìä –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –∑–∞—Ö–≤–∞—Ç –≤ —Å—Ç–∞—Ç—É—Å–µ "–ì–æ—Ç–æ–≤"'),t.n=1,i.captureCallData();case 1:return t.a(2)}},t)})),500)),this.lastAgentStatus=n);case 2:return t.a(2)}},t,this)})),function(t){return m.apply(this,arguments)})},{key:"startActiveCallMonitoring",value:function(){console.log("üéØ –ó–∞–ø—É—Å–∫ –∞–∫—Ç–∏–≤–Ω–æ–≥–æ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –∑–≤–æ–Ω–∫–∞"),chrome.alarms.create("activeCallMonitor",{periodInMinutes:.0167}),this.captureCallData()}},{key:"captureCallData",value:(d=l(a().m(function t(){var e,n,r;return a().w(function(t){for(;;)switch(t.p=t.n){case 0:if(this.finesseTabId){t.n=1;break}return t.a(2);case 1:return t.p=1,t.n=2,chrome.scripting.executeScript({target:{tabId:this.finesseTabId},func:h,world:"MAIN"});case 2:(e=t.v)&&e[0]&&e[0].result&&((n=e[0].result).phone||n.duration)&&(this.currentCallData=n,console.log("üìä –î–∞–Ω–Ω—ã–µ –∑–≤–æ–Ω–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω—ã:",n)),t.n=4;break;case 3:t.p=3,r=t.v,console.error("‚ùå –û—à–∏–±–∫–∞ –∑–∞—Ö–≤–∞—Ç–∞ –¥–∞–Ω–Ω—ã—Ö –∑–≤–æ–Ω–∫–∞:",r);case 4:return t.a(2)}},t,this,[[1,3]])})),function(){return d.apply(this,arguments)})},{key:"startPostCallCapture",value:(u=l(a().m(function t(){var e,n,r,o=this;return a().w(function(t){for(;;)switch(t.n){case 0:console.log('üîÑ –ó–∞–ø—É—Å–∫ –±—ã—Å—Ç—Ä–æ–≥–æ –∑–∞—Ö–≤–∞—Ç–∞ –≤ —Å—Ç–∞—Ç—É—Å–µ "–ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ"'),this.isInCall=!1,chrome.alarms.clear("activeCallMonitor"),e=0,n=Date.now(),r=function(){var t=l(a().m(function t(){var i,l;return a().w(function(t){for(;;)switch(t.n){case 0:if(!((l=Date.now()-n)>3e3)){t.n=2;break}return console.log("‚è∞ –û–∫–Ω–æ –∑–∞—Ö–≤–∞—Ç–∞ (3 —Å–µ–∫) –∏—Å—Ç–µ–∫–ª–æ, –∏—Å–ø–æ–ª—å–∑—É–µ–º –≤—ã—á–∏—Å–ª–µ–Ω–Ω—É—é –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å"),t.n=1,o.finalizeCallWithCalculatedDuration();case 1:return t.a(2);case 2:return e++,console.log("üì∏ –ë—ã—Å—Ç—Ä—ã–π –∑–∞—Ö–≤–∞—Ç ".concat(e,"/").concat(3," (").concat(l,'–º—Å –æ—Ç –Ω–∞—á–∞–ª–∞ "–ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ")')),t.n=3,o.captureCallData();case 3:if(!(null===(i=o.currentCallData)||void 0===i?void 0:i.duration)||"00:00:00"===o.currentCallData.duration||!/\d{2}:\d{2}:\d{2}/.test(o.currentCallData.duration)){t.n=5;break}return console.log("‚úÖ –ü–æ–ª—É—á–µ–Ω–æ —Ñ–∏–Ω–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è –∏–∑ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞:",o.currentCallData.duration),t.n=4,o.finalizeCall();case 4:return t.a(2);case 5:if(!(e>=3)){t.n=7;break}return console.log("‚è∞ –ò—Å—á–µ—Ä–ø–∞–Ω—ã –ø–æ–ø—ã—Ç–∫–∏ –±—ã—Å—Ç—Ä–æ–≥–æ –∑–∞—Ö–≤–∞—Ç–∞, –∏—Å–ø–æ–ª—å–∑—É–µ–º –≤—ã—á–∏—Å–ª–µ–Ω–Ω—É—é –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å"),t.n=6,o.finalizeCallWithCalculatedDuration();case 6:return t.a(2);case 7:setTimeout(r,100);case 8:return t.a(2)}},t)}));return function(){return t.apply(this,arguments)}}(),r();case 1:return t.a(2)}},t,this)})),function(){return u.apply(this,arguments)})},{key:"finalizeCallWithCalculatedDuration",value:(s=l(a().m(function t(){var e,r,o,i;return a().w(function(t){for(;;)switch(t.n){case 0:return o={phone:(null===(e=this.currentCallData)||void 0===e?void 0:e.phone)||"–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ",duration:this.calculatedDuration||"00:00:00",region:(null===(r=this.currentCallData)||void 0===r?void 0:r.region)||"–ù–µ —É–∫–∞–∑–∞–Ω",timestamp:Date.now(),source:"calculated"},console.log("üíæ –§–∏–Ω–∞–ª–∏–∑–∞—Ü–∏—è —Å –≤—ã—á–∏—Å–ª–µ–Ω–Ω–æ–π –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å—é:",o),i=n(n({},o),{},{completedAt:(new Date).toISOString(),savedAt:Date.now(),callStartTime:this.callStartTime,callEndTime:this.callEndTime}),this.callHistory.unshift(i),this.callHistory.length>10&&(this.callHistory=this.callHistory.slice(0,10)),t.n=1,this.saveData();case 1:this.currentCallData=null,this.callStartTime=null,this.callEndTime=null,this.calculatedDuration=null,console.log("‚úÖ –ó–≤–æ–Ω–æ–∫ —Å–æ—Ö—Ä–∞–Ω–µ–Ω —Å –≤—ã—á–∏—Å–ª–µ–Ω–Ω–æ–π –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å—é");case 2:return t.a(2)}},t,this)})),function(){return s.apply(this,arguments)})},{key:"finalizeCall",value:(i=l(a().m(function t(){var e;return a().w(function(t){for(;;)switch(t.n){case 0:if(this.currentCallData){t.n=2;break}return console.warn("‚ö†Ô∏è –ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è, –∏—Å–ø–æ–ª—å–∑—É–µ–º –≤—ã—á–∏—Å–ª–µ–Ω–Ω—É—é –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å"),t.n=1,this.finalizeCallWithCalculatedDuration();case 1:return t.a(2);case 2:return console.log("üíæ –§–∏–Ω–∞–ª–∏–∑–∞—Ü–∏—è –∑–≤–æ–Ω–∫–∞ —Å –¥–∞–Ω–Ω—ã–º–∏ –∏–∑ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞:",this.currentCallData),e=n(n({},this.currentCallData),{},{completedAt:(new Date).toISOString(),savedAt:Date.now(),source:"interface",callStartTime:this.callStartTime,callEndTime:this.callEndTime,calculatedDuration:this.calculatedDuration}),this.callHistory.unshift(e),this.callHistory.length>10&&(this.callHistory=this.callHistory.slice(0,10)),t.n=3,this.saveData();case 3:this.currentCallData=null,this.callStartTime=null,this.callEndTime=null,this.calculatedDuration=null,console.log("‚úÖ –ó–≤–æ–Ω–æ–∫ —Å–æ—Ö—Ä–∞–Ω–µ–Ω —Å –¥–∞–Ω–Ω—ã–º–∏ –∏–∑ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞");case 4:return t.a(2)}},t,this)})),function(){return i.apply(this,arguments)})},{key:"saveData",value:(o=l(a().m(function t(){var e;return a().w(function(t){for(;;)switch(t.p=t.n){case 0:return t.p=0,t.n=1,chrome.storage.local.set({callHistory:this.callHistory,lastCallData:this.callHistory[0]||null,lastAgentStatus:this.lastAgentStatus,lastUpdate:Date.now()});case 1:console.log("üíæ –î–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤ storage"),t.n=3;break;case 2:t.p=2,e=t.v,console.error("‚ùå –û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è:",e);case 3:return t.a(2)}},t,this,[[0,2]])})),function(){return o.apply(this,arguments)})},{key:"loadStoredData",value:(r=l(a().m(function t(){var e,n;return a().w(function(t){for(;;)switch(t.p=t.n){case 0:return t.p=0,t.n=1,chrome.storage.local.get(["callHistory","lastAgentStatus"]);case 1:(e=t.v).callHistory&&(this.callHistory=e.callHistory,console.log("üìö –ó–∞–≥—Ä—É–∂–µ–Ω–∞ –∏—Å—Ç–æ—Ä–∏—è: ".concat(this.callHistory.length," –∑–≤–æ–Ω–∫–æ–≤"))),e.lastAgentStatus&&(this.lastAgentStatus=e.lastAgentStatus),t.n=3;break;case 2:t.p=2,n=t.v,console.error("‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö:",n);case 3:return t.a(2)}},t,this,[[0,2]])})),function(){return r.apply(this,arguments)})}],e&&c(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,o,i,s,u,d,m,g,p,v}());chrome.alarms.onAlarm.addListener(function(){var t=l(a().m(function t(e){return a().w(function(t){for(;;)switch(t.n){case 0:if("finesseStatusCheck"!==e.name){t.n=2;break}return t.n=1,d.checkAgentStatus();case 1:t.n=3;break;case 2:if("activeCallMonitor"!==e.name){t.n=3;break}return t.n=3,d.captureCallData();case 3:return t.a(2)}},t)}));return function(e){return t.apply(this,arguments)}}()),chrome.runtime.onMessage.addListener(function(t,e,n){return console.log("üì® –ü–æ–ª—É—á–µ–Ω –∑–∞–ø—Ä–æ—Å:",t.action),"getCallData"===t.action?(n({status:"success",data:d.callHistory}),!0):"test"===t.action?(n({status:"success",message:"Background service —Ä–∞–±–æ—Ç–∞–µ—Ç",monitorActive:d.monitoringActive,historyCount:d.callHistory.length}),!0):void 0}),globalThis.monitorStatus=l(a().m(function t(){return a().w(function(t){for(;;)switch(t.n){case 0:console.group("üìä –°—Ç–∞—Ç—É—Å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞"),console.log("–ê–∫—Ç–∏–≤–µ–Ω:",d.monitoringActive),console.log("Tab ID:",d.finesseTabId),console.log("–ü–æ—Å–ª–µ–¥–Ω–∏–π —Å—Ç–∞—Ç—É—Å:",d.lastAgentStatus),console.log("–í –∑–≤–æ–Ω–∫–µ:",d.isInCall),console.log("–¢–µ–∫—É—â–∏–µ –¥–∞–Ω–Ω—ã–µ:",d.currentCallData),console.log("–ò—Å—Ç–æ—Ä–∏—è:",d.callHistory.length,"–∑–≤–æ–Ω–∫–æ–≤"),console.groupEnd();case 1:return t.a(2)}},t)})),globalThis.forceCheck=l(a().m(function t(){return a().w(function(t){for(;;)switch(t.n){case 0:return console.log("üîÑ –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞..."),t.n=1,d.checkAgentStatus();case 1:return t.a(2)}},t)})),console.log("‚úÖ Background Service Worker –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ"),console.log("üí° –ö–æ–º–∞–Ω–¥—ã: monitorStatus(), forceCheck()")})();